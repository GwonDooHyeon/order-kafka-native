# Producerì™€ Consumer ê¸°ë³¸ ê°œë…

## ğŸ“Œ Producerë€?

### ì •ì˜
- Kafkaë¡œ **ë©”ì‹œì§€ë¥¼ ì „ì†¡**í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜
- Topicì˜ íŠ¹ì • Partitionì— ë©”ì‹œì§€ë¥¼ appendí•¨

### í•µì‹¬ êµ¬ì„± ìš”ì†Œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Producer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Serializerâ”‚ â†’ â”‚ Partitioner â”‚ â†’ â”‚ Record Accumulatorâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                           â”‚             â”‚
â”‚                                     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”       â”‚
â”‚                                     â”‚   Sender  â”‚       â”‚
â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

1. **Serializer**: Key/Valueë¥¼ byte[]ë¡œ ë³€í™˜
2. **Partitioner**: ì–´ëŠ Partitionì— ë³´ë‚¼ì§€ ê²°ì •
3. **Record Accumulator**: ë©”ì‹œì§€ë¥¼ ë°°ì¹˜ë¡œ ëª¨ìŒ
4. **Sender**: ì‹¤ì œë¡œ Brokerì— ì „ì†¡

---

## ğŸ“Œ Consumerë€?

### ì •ì˜
- Kafkaì—ì„œ **ë©”ì‹œì§€ë¥¼ ì½ì–´ì˜¤ëŠ”** í´ë¼ì´ì–¸íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜
- poll() ë©”ì„œë“œë¡œ Brokerì—ì„œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì˜´

### í•µì‹¬ êµ¬ì„± ìš”ì†Œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Consumer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Fetcher â”‚ â†’ â”‚ Deserializer â”‚ â†’ â”‚ ConsumerRecords â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚  â”‚ Offset Management  â”‚                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

1. **Fetcher**: Brokerì—ì„œ ë©”ì‹œì§€ë¥¼ ê°€ì ¸ì˜´
2. **Deserializer**: byte[]ë¥¼ ê°ì²´ë¡œ ë³€í™˜
3. **Offset Management**: ì–´ë””ê¹Œì§€ ì½ì—ˆëŠ”ì§€ ì¶”ì 

---

## ğŸ”„ ì „ì²´ ë°ì´í„° íë¦„

```
Producer                    Kafka Cluster                 Consumer
   â”‚                              â”‚                           â”‚
   â”‚  1. ProducerRecord ìƒì„±      â”‚                           â”‚
   â”‚  2. serialize()              â”‚                           â”‚
   â”‚  3. partition ê²°ì •           â”‚                           â”‚
   â”‚                              â”‚                           â”‚
   â”‚ â”€â”€â”€â”€â”€â”€â”€ send() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚                           â”‚
   â”‚                              â”‚  4. Partitionì— ì €ì¥      â”‚
   â”‚                              â”‚                           â”‚
   â”‚                              â”‚  â†â”€â”€â”€â”€â”€â”€â”€ poll() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
   â”‚                              â”‚                           â”‚
   â”‚                              â”‚  5. ë©”ì‹œì§€ ë°˜í™˜           â”‚
   â”‚                              â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
   â”‚                              â”‚                           â”‚
   â”‚                              â”‚  6. commit offset         â”‚
   â”‚                              â”‚  â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
```

---

## ğŸ’» Java ì½”ë“œë¡œ ì´í•´í•˜ê¸°

### Producer ê¸°ë³¸ íë¦„
```java
// 1. ì„¤ì •
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("key.serializer", StringSerializer.class.getName());
props.put("value.serializer", StringSerializer.class.getName());

// 2. Producer ìƒì„±
KafkaProducer<String, String> producer = new KafkaProducer<>(props);

// 3. ë©”ì‹œì§€ ì „ì†¡
ProducerRecord<String, String> record =
    new ProducerRecord<>("topic", "key", "value");
producer.send(record);

// 4. ì •ë¦¬
producer.flush();
producer.close();
```

### Consumer ê¸°ë³¸ íë¦„
```java
// 1. ì„¤ì •
Properties props = new Properties();
props.put("bootstrap.servers", "localhost:9092");
props.put("group.id", "my-group");
props.put("key.deserializer", StringDeserializer.class.getName());
props.put("value.deserializer", StringDeserializer.class.getName());

// 2. Consumer ìƒì„±
KafkaConsumer<String, String> consumer = new KafkaConsumer<>(props);

// 3. Topic êµ¬ë…
consumer.subscribe(Arrays.asList("topic"));

// 4. ë©”ì‹œì§€ í´ë§
while (true) {
    ConsumerRecords<String, String> records = consumer.poll(Duration.ofMillis(100));
    for (ConsumerRecord<String, String> record : records) {
        System.out.println(record.value());
    }
}
```

---

## ğŸ¯ Producer ì£¼ìš” ì„¤ì •

| ì„¤ì • | ì„¤ëª… | ê¸°ë³¸ê°’ |
|-----|------|-------|
| `bootstrap.servers` | Kafka ë¸Œë¡œì»¤ ì£¼ì†Œ | í•„ìˆ˜ |
| `key.serializer` | Key ì§ë ¬í™” í´ë˜ìŠ¤ | í•„ìˆ˜ |
| `value.serializer` | Value ì§ë ¬í™” í´ë˜ìŠ¤ | í•„ìˆ˜ |
| `acks` | ì „ì†¡ í™•ì¸ ìˆ˜ì¤€ | `all` |
| `retries` | ì¬ì‹œë„ íšŸìˆ˜ | 2147483647 |
| `batch.size` | ë°°ì¹˜ í¬ê¸° (bytes) | 16384 |
| `linger.ms` | ë°°ì¹˜ ëŒ€ê¸° ì‹œê°„ | 0 |

---

## ğŸ¯ Consumer ì£¼ìš” ì„¤ì •

| ì„¤ì • | ì„¤ëª… | ê¸°ë³¸ê°’ |
|-----|------|-------|
| `bootstrap.servers` | Kafka ë¸Œë¡œì»¤ ì£¼ì†Œ | í•„ìˆ˜ |
| `group.id` | Consumer Group ID | í•„ìˆ˜ |
| `key.deserializer` | Key ì—­ì§ë ¬í™” í´ë˜ìŠ¤ | í•„ìˆ˜ |
| `value.deserializer` | Value ì—­ì§ë ¬í™” í´ë˜ìŠ¤ | í•„ìˆ˜ |
| `auto.offset.reset` | ì´ˆê¸° ì˜¤í”„ì…‹ ì„¤ì • | `latest` |
| `enable.auto.commit` | ìë™ ì»¤ë°‹ ì—¬ë¶€ | `true` |
| `max.poll.records` | pollë‹¹ ìµœëŒ€ ë ˆì½”ë“œ ìˆ˜ | 500 |

---

## ğŸ§ª ì§ì ‘ í’€ì–´ë³¼ ë¬¸ì œ

### ë¬¸ì œ 1: Producer íë¦„ ì¶”ì 
**ëª©í‘œ:** Producer ë‚´ë¶€ ë™ì‘ ìˆœì„œ ì´í•´

í˜„ì¬ í”„ë¡œì íŠ¸ì˜ `SimpleProducer.java`ë¥¼ ë³´ê³  ë‹¤ìŒ ì§ˆë¬¸ì— ë‹µí•˜ì„¸ìš”:

1. ë©”ì‹œì§€ê°€ ì–´ë–¤ Partitionì— ì €ì¥ë ì§€ ì–´ë–»ê²Œ ê²°ì •ë˜ë‚˜ìš”?
2. `flush()`ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?
3. `close()`ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?

---

### ë¬¸ì œ 2: Consumer Group ì‹¤í—˜
**ëª©í‘œ:** group.idì˜ ì—­í•  ì´í•´

1. ê°™ì€ group.idë¡œ Consumer 2ê°œ ì‹¤í–‰
2. ë‹¤ë¥¸ group.idë¡œ Consumer 2ê°œ ì‹¤í–‰
3. ë©”ì‹œì§€ ì „ì†¡ í›„ ì–´ë–¤ Consumerê°€ ë°›ëŠ”ì§€ í™•ì¸

**ì˜ˆìƒ ê²°ê³¼:**
- ê°™ì€ ê·¸ë£¹: ë©”ì‹œì§€ê°€ **ë¶„ë°°**ë¨ (ê°ì ì¼ë¶€ë§Œ ë°›ìŒ)
- ë‹¤ë¥¸ ê·¸ë£¹: ë©”ì‹œì§€ê°€ **ë³µì œ**ë¨ (ëª¨ë‘ ì „ì²´ë¥¼ ë°›ìŒ)

---

### ë¬¸ì œ 3: SimpleConsumer.java ì‘ì„±
**ëª©í‘œ:** ê¸°ë³¸ Consumer ì§ì ‘ êµ¬í˜„

`consumer/src/main/java/SimpleConsumer.java` íŒŒì¼ì„ ìƒì„±í•˜ê³ :
1. `simple-topic` êµ¬ë…
2. ë©”ì‹œì§€ë¥¼ ë°›ìœ¼ë©´ ì½˜ì†”ì— ì¶œë ¥
3. Ctrl+Cë¡œ ì¢…ë£Œ ì‹œ ë¦¬ì†ŒìŠ¤ ì •ë¦¬

```java
// TODO: ì—¬ê¸°ì— êµ¬í˜„
```

---

## ğŸ” í•µì‹¬ ì •ë¦¬

| êµ¬ë¶„ | Producer | Consumer |
|-----|---------|----------|
| ì—­í•  | ë©”ì‹œì§€ ì „ì†¡ | ë©”ì‹œì§€ ìˆ˜ì‹  |
| í•µì‹¬ ë©”ì„œë“œ | send() | poll() |
| í•„ìˆ˜ ì„¤ì • | bootstrap.servers, serializers | bootstrap.servers, group.id, deserializers |
| ë°ì´í„° ë³€í™˜ | ê°ì²´ â†’ byte[] | byte[] â†’ ê°ì²´ |

---

## ğŸ“ í•™ìŠµ ë…¸íŠ¸

> ì—¬ê¸°ì— ê°•ì˜ë¥¼ ë“¤ìœ¼ë©´ì„œ ì¶”ê°€ë¡œ ë°°ìš´ ë‚´ìš©ì´ë‚˜ ê¶ê¸ˆí•œ ì ì„ ê¸°ë¡í•˜ì„¸ìš”.

```
-
-
-
```
